# go-deamon

启动进程消费队列数据是很常见应用场景，每次对文件修改都需要kill 掉老进程，进行重启，这个过程可能会丢失正在处理数据，
**比如下面这个例子：**
```golang
$i = 1;
for {
    echo "开始第[{$i}]次循环\n";
    sleep(10);
    echo "结束第[{$i}]次循环\n";
    $i++;
}
```
当我们运行脚本之后，等到循环开始之后，给进程发送 kill {$pid}，默认发送的是编号为15的SIGTERM信号。假设$i是从队列拿到的，拿到2的时候，正在处理，我们给程序发送了kill信号，和队列数据丢失一样，问题比较大，因此我要想办法解决这些问题。

**运行结果**

开始第[1]次循环
结束第[1]次循环
开始第[2]次循环

[1]    28372 terminated  go run t.go

此时就会丢失第二次循环数据

**采用信号量解决数据丢失**
信号量会打断系统调用，让系统调用立刻返回。此时监听系统quitchan，并将正在处理数据重新放入redis 队列，解决数据丢失问题。







